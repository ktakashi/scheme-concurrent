(define (run n*)
  (let ((tp (make-thread-pool 10))
	(sq (make-shared-queue)))
    (let loop ((n* n*))
      (if (null? n*)
	  (thread-pool-release! tp)
	  (let ((p (heavy-task (car n*))))
	    (thread-pool-push-task! tp (lambda () (shared-queue-put! sq (p))))
	    (loop (cdr n*)))))))
